<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëŒ€í™”í˜• ë„ì„œ ëŒ€ì—¬ ê´€ë¦¬ í”„ë¡œê·¸ë¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals -->
    <!-- Application Structure Plan: A tab-based dashboard simulating the Excel environment. Users can switch between 'Dashboard', 'Book List', 'Member List', and 'Rental/Return' views. This structure was chosen because it directly mimics the multi-sheet system of the source Excel guide, making it intuitive for users to understand the relationships between different data sets. Interactive forms for renting/returning books provide a hands-on experience, while dynamic charts and stats offer immediate visual feedback, transforming a static guide into an engaging learning tool. -->
    <!-- Visualization & Content Choices: 
        - Overall Stats (Total Books, Members, On Loan): Goal=Inform, Method=Dynamic Text Cards, Interaction=Real-time updates, Justification=Provides a quick overview of the library's status.
        - Book/Member Lists: Goal=Organize, Method=Interactive HTML Tables, Interaction=Search/Filter, Justification=Allows easy data lookup, simulating Excel's filter functionality.
        - Rental/Return Log: Goal=Change/Track, Method=Interactive HTML Table with Forms, Interaction=Users can add new rentals and process returns, Justification=This is the core interactive component, simulating the primary function of the Excel program.
        - Book Status Chart: Goal=Compare, Method=Chart.js Doughnut Chart, Interaction=Updates on rental/return actions, Justification=Visually represents the proportion of available vs. loaned books.
        - Rentals by Book Chart: Goal=Compare, Method=Chart.js Bar Chart, Interaction=Updates with new rentals, Justification=Shows book popularity at a glance.
        - All dynamic updates (e.g., auto-filling names, changing status) simulate Excel formulas (VLOOKUP, IF, COUNTIF) to teach their practical application.
        Library/Method: Tailwind CSS, Vanilla JS, Chart.js (Canvas). -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        .tab-active { border-color: #3b82f6; color: #3b82f6; background-color: #eff6ff; }
        .tab-inactive { border-color: transparent; }
        .chart-container { position: relative; width: 100%; max-width: 500px; margin-left: auto; margin-right: auto; height: 300px; max-height: 350px; }
        @media (min-width: 768px) { .chart-container { height: 350px; } }
        .table-wrp { max-height: 400px; overflow-y: auto; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-900">ëŒ€í™”í˜• ë„ì„œ ëŒ€ì—¬ ê´€ë¦¬ í”„ë¡œê·¸ë¨</h1>
            <p class="mt-2 text-slate-600">ì—‘ì…€ ê°€ì´ë“œ ê¸°ë°˜ì˜ ë„ì„œ ê´€ë¦¬ ì‹œìŠ¤í…œ ì‹œë®¬ë ˆì´ì…˜</p>
        </header>

        <div class="bg-white p-4 sm:p-6 rounded-2xl shadow-lg">
            
            <div class="border-b border-slate-200 mb-6">
                <nav class="flex flex-wrap -mb-px" id="nav-tabs">
                     <button data-tab="dashboard" class="nav-tab tab-active text-sm sm:text-base font-medium text-center p-3 sm:p-4 border-b-2 rounded-t-lg">ğŸ“Š ëŒ€ì‹œë³´ë“œ</button>
                    <button data-tab="rent-return" class="nav-tab tab-inactive text-sm sm:text-base font-medium text-center p-3 sm:p-4 border-b-2 rounded-t-lg">ğŸ”„ ëŒ€ì—¬/ë°˜ë‚©</button>
                    <button data-tab="books" class="nav-tab tab-inactive text-sm sm:text-base font-medium text-center p-3 sm:p-4 border-b-2 rounded-t-lg">ğŸ“š ë„ì„œ ëª©ë¡</button>
                    <button data-tab="members" class="nav-tab tab-inactive text-sm sm:text-base font-medium text-center p-3 sm:p-4 border-b-2 rounded-t-lg">ğŸ‘¥ íšŒì› ëª…ë¶€</button>
                </nav>
            </div>

            <main id="main-content">
                
                <div id="dashboard-content" class="tab-content">
                    <div class="mb-6">
                        <h2 class="text-xl font-bold text-slate-800 mb-1">í˜„í™© ìš”ì•½</h2>
                        <p class="text-slate-500">í˜„ì¬ ë„ì„œê´€ì˜ ì£¼ìš” ì§€í‘œë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í•©ë‹ˆë‹¤.</p>
                    </div>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center mb-8">
                        <div class="bg-blue-50 p-4 rounded-xl">
                            <h3 class="text-sm font-bold text-blue-600">ì´ ë„ì„œ</h3>
                            <p id="total-books-stat" class="text-3xl font-bold text-blue-800"></p>
                        </div>
                        <div class="bg-green-50 p-4 rounded-xl">
                            <h3 class="text-sm font-bold text-green-600">ëŒ€ì—¬ ê°€ëŠ¥</h3>
                            <p id="available-books-stat" class="text-3xl font-bold text-green-800"></p>
                        </div>
                        <div class="bg-amber-50 p-4 rounded-xl">
                            <h3 class="text-sm font-bold text-amber-600">ëŒ€ì—¬ì¤‘</h3>
                            <p id="on-loan-stat" class="text-3xl font-bold text-amber-800"></p>
                        </div>
                        <div class="bg-indigo-50 p-4 rounded-xl">
                            <h3 class="text-sm font-bold text-indigo-600">ì´ íšŒì›</h3>
                            <p id="total-members-stat" class="text-3xl font-bold text-indigo-800"></p>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div>
                             <h2 class="text-xl font-bold text-slate-800 mb-1 text-center">ë„ì„œ ìƒíƒœ í˜„í™©</h2>
                             <p class="text-slate-500 mb-4 text-center">ëŒ€ì—¬ ê°€ëŠ¥ ë° ëŒ€ì—¬ì¤‘ì¸ ë„ì„œì˜ ë¹„ìœ¨ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.</p>
                            <div class="chart-container">
                                <canvas id="bookStatusChart"></canvas>
                            </div>
                        </div>
                        <div>
                             <h2 class="text-xl font-bold text-slate-800 mb-1 text-center">ë„ì„œë³„ ëŒ€ì—¬ íšŸìˆ˜</h2>
                             <p class="text-slate-500 mb-4 text-center">ê°€ì¥ ë§ì´ ëŒ€ì—¬ëœ ë„ì„œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                            <div class="chart-container">
                                <canvas id="rentalsByBookChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="rent-return-content" class="tab-content hidden">
                    <div class="mb-6">
                        <h2 class="text-xl font-bold text-slate-800 mb-1">ë„ì„œ ëŒ€ì—¬í•˜ê¸°</h2>
                        <p class="text-slate-500">ìƒˆë¡œìš´ ëŒ€ì—¬ ê¸°ë¡ì„ ì¶”ê°€í•©ë‹ˆë‹¤. ë„ì„œë²ˆí˜¸ì™€ íšŒì›ë²ˆí˜¸ë¥¼ ì„ íƒí•˜ë©´ ì´ë¦„ì´ ìë™ìœ¼ë¡œ ì…ë ¥ë©ë‹ˆë‹¤. (VLOOKUP ì‹œë®¬ë ˆì´ì…˜)</p>
                    </div>
                    <form id="rental-form" class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end bg-slate-50 p-4 rounded-lg mb-8">
                        <div>
                            <label for="rental-book-id" class="block text-sm font-medium text-slate-700">ë„ì„œë²ˆí˜¸</label>
                            <select id="rental-book-id" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"></select>
                        </div>
                        <div>
                            <label for="rental-member-id" class="block text-sm font-medium text-slate-700">íšŒì›ë²ˆí˜¸</label>
                            <select id="rental-member-id" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"></select>
                        </div>
                        <div>
                            <label for="rental-date" class="block text-sm font-medium text-slate-700">ëŒ€ì—¬ì¼</label>
                            <input type="date" id="rental-date" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        </div>
                        <button type="submit" class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700 transition-colors">ëŒ€ì—¬ ë“±ë¡</button>
                    </form>
                    
                    <div class="mb-6">
                        <h2 class="text-xl font-bold text-slate-800 mb-1">ëŒ€ì—¬/ë°˜ë‚© ê¸°ë¡</h2>
                        <p class="text-slate-500">'ë°˜ë‚©' ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì˜¤ëŠ˜ ë‚ ì§œë¡œ ë°˜ë‚© ì²˜ë¦¬ë©ë‹ˆë‹¤.</p>
                    </div>
                    <div class="table-wrp border border-slate-200 rounded-lg">
                        <table class="min-w-full divide-y divide-slate-200">
                            <thead class="bg-slate-50 sticky top-0">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">ëŒ€ì—¬ì¼</th>
                                    <th class="px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">ë„ì„œëª…</th>
                                    <th class="px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">íšŒì›ì´ë¦„</th>
                                    <th class="px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">ë°˜ë‚©ì˜ˆì •ì¼</th>
                                    <th class="px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">ìƒíƒœ</th>
                                    <th class="px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">ì²˜ë¦¬</th>
                                </tr>
                            </thead>
                            <tbody id="rental-log-body" class="bg-white divide-y divide-slate-200">
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="books-content" class="tab-content hidden">
                     <div class="mb-6">
                        <h2 class="text-xl font-bold text-slate-800 mb-1">ë„ì„œ ëª©ë¡</h2>
                        <p class="text-slate-500">'ëŒ€ì—¬ìƒíƒœ'ëŠ” ëŒ€ì—¬/ë°˜ë‚© ê¸°ë¡ì— ë”°ë¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ìë™ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤. (COUNTIF + IF í•¨ìˆ˜ ì‹œë®¬ë ˆì´ì…˜)</p>
                    </div>
                    <div class="mb-4">
                        <input type="text" id="book-search" placeholder="ë„ì„œëª… ë˜ëŠ” ì €ìë¡œ ê²€ìƒ‰..." class="block w-full md:w-1/2 rounded-md border-slate-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                    </div>
                    <div class="table-wrp border border-slate-200 rounded-lg">
                        <table class="min-w-full divide-y divide-slate-200">
                            <thead class="bg-slate-50 sticky top-0">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">ë„ì„œë²ˆí˜¸</th>
                                    <th class="px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">ë„ì„œëª…</th>
                                    <th class="px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">ì €ì</th>
                                    <th class="px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">ëŒ€ì—¬ìƒíƒœ</th>
                                </tr>
                            </thead>
                            <tbody id="book-list-body" class="bg-white divide-y divide-slate-200">
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div id="members-content" class="tab-content hidden">
                    <div class="mb-6">
                        <h2 class="text-xl font-bold text-slate-800 mb-1">íšŒì› ëª…ë¶€</h2>
                         <p class="text-slate-500">ì „ì²´ íšŒì› ëª©ë¡ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
                    </div>
                     <div class="mb-4">
                        <input type="text" id="member-search" placeholder="ì´ë¦„ ë˜ëŠ” ì—°ë½ì²˜ë¡œ ê²€ìƒ‰..." class="block w-full md:w-1/2 rounded-md border-slate-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                    </div>
                    <div class="table-wrp border border-slate-200 rounded-lg">
                        <table class="min-w-full divide-y divide-slate-200">
                            <thead class="bg-slate-50 sticky top-0">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">íšŒì›ë²ˆí˜¸</th>
                                    <th class="px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">ì´ë¦„</th>
                                    <th class="px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">ì—°ë½ì²˜</th>
                                    <th class="px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">ê°€ì…ì¼</th>
                                </tr>
                            </thead>
                            <tbody id="member-list-body" class="bg-white divide-y divide-slate-200">
                            </tbody>
                        </table>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            
            let books = [
                { id: 'B-001', title: 'ì—‘ì…€ ë°ì´í„° ë¶„ì„', author: 'ê¹€í•˜ë‚˜', publisher: 'ì˜¤í”¼ìŠ¤' },
                { id: 'B-002', title: 'íŒŒì´ì¬ ì™„ì „ ì •ë³µ', author: 'ë°•ì½”ë”©', publisher: 'ì´ì§€ìŠ¤' },
                { id: 'B-003', title: 'ë§›ìˆëŠ” ë””ìì¸ í¬í† ìƒµ', author: 'ì´ë””ìì¸', publisher: 'í•œë¹›ë¯¸ë””ì–´' },
                { id: 'B-004', title: 'ì²˜ìŒ ì‹œì‘í•˜ëŠ” SQL', author: 'ìµœë°ì´í„°', publisher: 'ë°ì´í„°ë¶ìŠ¤' },
                { id: 'B-005', title: 'ì›¹ í‘œì¤€ì˜ ì •ì„', author: 'ê³ ì›¹ì§„', publisher: 'ì¸ì‚¬ì´íŠ¸' }
            ];

            let members = [
                { id: 'M-001', name: 'ì´ì§€ì€', phone: '010-1234-5678', joinDate: '2025-01-05' },
                { id: 'M-002', name: 'ê¹€ì² ìˆ˜', phone: '010-9876-5432', joinDate: '2025-02-11' },
                { id: 'M-003', name: 'ë°•ì˜í¬', phone: '010-5555-4444', joinDate: '2025-03-20' }
            ];

            let rentals = [
                { logId: 1, bookId: 'B-002', memberId: 'M-001', rentalDate: '2025-07-01', returnDate: null },
                { logId: 2, bookId: 'B-001', memberId: 'M-003', rentalDate: '2025-07-03', returnDate: '2025-07-10' }
            ];

            const tabs = document.querySelectorAll('.nav-tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            const rentalForm = document.getElementById('rental-form');
            const rentalBookIdSelect = document.getElementById('rental-book-id');
            const rentalMemberIdSelect = document.getElementById('rental-member-id');
            const rentalDateInput = document.getElementById('rental-date');

            let bookStatusChart, rentalsByBookChart;
            
            const isBookOnLoan = (bookId) => {
                return rentals.some(r => r.bookId === bookId && r.returnDate === null);
            };

            const getBookById = (id) => books.find(b => b.id === id);
            const getMemberById = (id) => members.find(m => m.id === id);

            const renderBookList = (filter = '') => {
                const tbody = document.getElementById('book-list-body');
                tbody.innerHTML = '';
                const lowercasedFilter = filter.toLowerCase();
                const filteredBooks = books.filter(book => 
                    book.title.toLowerCase().includes(lowercasedFilter) || 
                    book.author.toLowerCase().includes(lowercasedFilter)
                );

                filteredBooks.forEach(book => {
                    const onLoan = isBookOnLoan(book.id);
                    const statusClass = onLoan ? 'text-amber-600 bg-amber-100' : 'text-green-600 bg-green-100';
                    const statusText = onLoan ? 'ëŒ€ì—¬ì¤‘' : 'ëŒ€ì—¬ê°€ëŠ¥';
                    const row = `
                        <tr>
                            <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">${book.id}</td>
                            <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-slate-900">${book.title}</td>
                            <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">${book.author}</td>
                            <td class="px-4 py-3 whitespace-nowrap text-sm"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${statusClass}">${statusText}</span></td>
                        </tr>
                    `;
                    tbody.innerHTML += row;
                });
            };

            const renderMemberList = (filter = '') => {
                const tbody = document.getElementById('member-list-body');
                tbody.innerHTML = '';
                 const lowercasedFilter = filter.toLowerCase();
                const filteredMembers = members.filter(member => 
                    member.name.toLowerCase().includes(lowercasedFilter) || 
                    member.phone.includes(filter)
                );

                filteredMembers.forEach(member => {
                    const row = `
                        <tr>
                            <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">${member.id}</td>
                            <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-slate-900">${member.name}</td>
                            <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">${member.phone}</td>
                            <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">${member.joinDate}</td>
                        </tr>
                    `;
                    tbody.innerHTML += row;
                });
            };

            const renderRentalLog = () => {
                const tbody = document.getElementById('rental-log-body');
                tbody.innerHTML = '';
                rentals.sort((a, b) => new Date(b.rentalDate) - new Date(a.rentalDate));
                rentals.forEach(rental => {
                    const book = getBookById(rental.bookId);
                    const member = getMemberById(rental.memberId);
                    if (!book || !member) return;

                    const dueDate = new Date(rental.rentalDate);
                    dueDate.setDate(dueDate.getDate() + 15);
                    const dueDateString = dueDate.toISOString().split('T')[0];

                    const isReturned = rental.returnDate !== null;
                    const statusText = isReturned ? 'ë°˜ë‚©ì™„ë£Œ' : 'ëŒ€ì—¬ì¤‘';
                    const statusClass = isReturned ? 'text-slate-500' : 'text-amber-600 font-bold';
                    const buttonHtml = isReturned ? 
                        `<span class="text-sm text-slate-400">${rental.returnDate}</span>` :
                        `<button data-log-id="${rental.logId}" class="return-btn bg-blue-100 text-blue-700 hover:bg-blue-200 text-xs font-bold py-1 px-3 rounded-full">ë°˜ë‚©</button>`;

                    const row = `
                        <tr>
                            <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">${rental.rentalDate}</td>
                            <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-slate-900">${book.title}</td>
                            <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">${member.name}</td>
                            <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">${dueDateString}</td>
                            <td class="px-4 py-3 whitespace-nowrap text-sm ${statusClass}">${statusText}</td>
                            <td class="px-4 py-3 whitespace-nowrap text-sm">${buttonHtml}</td>
                        </tr>
                    `;
                    tbody.innerHTML += row;
                });
                
                document.querySelectorAll('.return-btn').forEach(btn => {
                    btn.addEventListener('click', handleReturn);
                });
            };

            const populateRentalForm = () => {
                rentalBookIdSelect.innerHTML = '<option value="">ë„ì„œ ì„ íƒ...</option>';
                books.forEach(book => {
                    if (!isBookOnLoan(book.id)) {
                        rentalBookIdSelect.innerHTML += `<option value="${book.id}">${book.title} (${book.id})</option>`;
                    }
                });

                rentalMemberIdSelect.innerHTML = '<option value="">íšŒì› ì„ íƒ...</option>';
                members.forEach(member => {
                    rentalMemberIdSelect.innerHTML += `<option value="${member.id}">${member.name} (${member.id})</option>`;
                });
                
                rentalDateInput.value = new Date().toISOString().split('T')[0];
            };
            
            const handleReturn = (e) => {
                const logId = parseInt(e.target.dataset.logId, 10);
                const rental = rentals.find(r => r.logId === logId);
                if (rental) {
                    rental.returnDate = new Date().toISOString().split('T')[0];
                    updateAll();
                }
            };

            const renderStats = () => {
                const onLoanCount = rentals.filter(r => r.returnDate === null).length;
                document.getElementById('total-books-stat').textContent = books.length;
                document.getElementById('available-books-stat').textContent = books.length - onLoanCount;
                document.getElementById('on-loan-stat').textContent = onLoanCount;
                document.getElementById('total-members-stat').textContent = members.length;
            };

            const renderCharts = () => {
                const onLoanCount = rentals.filter(r => r.returnDate === null).length;
                const availableCount = books.length - onLoanCount;

                const statusCtx = document.getElementById('bookStatusChart').getContext('2d');
                if (bookStatusChart) bookStatusChart.destroy();
                bookStatusChart = new Chart(statusCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['ëŒ€ì—¬ ê°€ëŠ¥', 'ëŒ€ì—¬ì¤‘'],
                        datasets: [{
                            data: [availableCount, onLoanCount],
                            backgroundColor: ['#22c55e', '#f59e0b'],
                            borderColor: '#ffffff',
                            borderWidth: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { position: 'bottom' } }
                    }
                });
                
                const rentalsByBookData = books.map(book => {
                    return {
                        title: book.title,
                        count: rentals.filter(r => r.bookId === book.id).length
                    };
                }).filter(b => b.count > 0).sort((a,b) => b.count - a.count);

                const rentalsCtx = document.getElementById('rentalsByBookChart').getContext('2d');
                if (rentalsByBookChart) rentalsByBookChart.destroy();
                rentalsByBookChart = new Chart(rentalsCtx, {
                    type: 'bar',
                    data: {
                        labels: rentalsByBookData.map(b => b.title),
                        datasets: [{
                            label: 'ì´ ëŒ€ì—¬ íšŸìˆ˜',
                            data: rentalsByBookData.map(b => b.count),
                            backgroundColor: '#3b82f6',
                            borderRadius: 4
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } },
                         scales: {
                            x: { suggestedMax: Math.max(...rentalsByBookData.map(b => b.count), 5) }
                         }
                    }
                });
            };
            
            function updateAll() {
                renderBookList(document.getElementById('book-search').value);
                renderMemberList(document.getElementById('member-search').value);
                renderRentalLog();
                populateRentalForm();
                renderStats();
                renderCharts();
            }

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => {
                        t.classList.remove('tab-active');
                        t.classList.add('tab-inactive');
                    });
                    tab.classList.add('tab-active');
                    tab.classList.remove('tab-inactive');

                    tabContents.forEach(content => content.classList.add('hidden'));
                    document.getElementById(`${tab.dataset.tab}-content`).classList.remove('hidden');
                });
            });

            rentalForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const bookId = rentalBookIdSelect.value;
                const memberId = rentalMemberIdSelect.value;
                const rentalDate = rentalDateInput.value;

                if (!bookId || !memberId || !rentalDate) {
                    alert('ëª¨ë“  í•„ë“œë¥¼ ì±„ì›Œì£¼ì„¸ìš”.');
                    return;
                }
                
                const newLogId = rentals.length > 0 ? Math.max(...rentals.map(r => r.logId)) + 1 : 1;
                rentals.push({
                    logId: newLogId,
                    bookId,
                    memberId,
                    rentalDate,
                    returnDate: null
                });
                
                rentalForm.reset();
                updateAll();
            });

            document.getElementById('book-search').addEventListener('input', (e) => renderBookList(e.target.value));
            document.getElementById('member-search').addEventListener('input', (e) => renderMemberList(e.target.value));

            updateAll();
        });
    </script>

</body>
</html>
